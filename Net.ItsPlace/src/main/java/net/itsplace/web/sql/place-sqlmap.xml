<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="web">
    <typeAlias type="net.itsplace.domain.PlaceComment" alias="PlaceComment"/>	    		   
    <typeAlias type="net.itsplace.domain.Place" alias="Place"/>	    		   
    
      
	
	  <select id="getPlace" resultClass="Place"  parameterClass="int">
         SELECT A.ISAUTH, A.FID, A.FNAME, A.LATITUDE, A.LONGITUDE, A.NLDNO, A.MOBILE, A.PHONE1,
    	 		A.IMAGEHOST, A.FILENAME, A.CATEGORY,  A.REMARK,
    	 		A.EMAIL, A.CLOSEDDAY, A.OPENDAY, A.WEBSITE, A.INFO, A.QRCODE, A.SAVEDATE, A.EDITDATE,
    	 		S.BASNAME AS SERVICETYPE,
    	 		P.BASNAME AS PLACETYPE,
		   	 	A.FULLADDRESS,
		   	 	A.SIDO,
		   	 	A.GUGUN,
		   	 	A.DONG,
		   	 	A.NEWADDRESS,
		   	 	A.PAYINFO,
		   	 	A.PARKINFO,
		   	 	A.BLDINFO
		 FROM 
		 	PLACE A
		 LEFT OUTER JOIN
		 	PBASCD S
         		ON A.SERVICETYPE = S.BASECD	
         		AND S.GRPCD = 'SERVICETYPE'
		 LEFT OUTER JOIN
		 	PBASCD P
         		ON A.PLACETYPE = P.BASECD	
         		AND P.GRPCD = 'PLACETYPE'
         WHERE FID = #fid#
         	AND A.ISAUTH ='Y'         	
      </select>
      <select id="getPlaceCommentList" resultClass="PlaceComment" parameterClass="int">
    	 SELECT sql_calc_found_rows A.FID,
    	  	    C.COMMENT, E.NAME, E.PROFILEIMAGEURL, C.EMAIL, C.SAVEDATE, C.CID 
		 FROM PLACE A		 	
		 LEFT OUTER JOIN
		 	  PLACECOMMENT C
         ON A.FID = C.FID        	
         LEFT OUTER JOIN
         	  PUSER E
         ON E.EMAIL = C.EMAIL	
         WHERE A.FID = #fid#	
         		AND C.ISDELETE = 'N'
         ORDER BY C.SAVEDATE DESC    	 	    	
    </select>
    
</sqlMap>
  
